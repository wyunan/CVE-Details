# 使用方式

python --url http://xxxx/xxx --method xxx
# 检测脚本原理

1. class.module.classLoader.defaultAssertionStatus属性一般默认为false，业务很少使用该属性。
2. 在存在该漏洞的项目环境中，更改class.module.classLoader.defaultAssertionStatus=xxxxx，classloader会去加载该属性，然后如果xxxx不是默认的true或者false，就会加载不到，从而服务端响应400状态码。如果更改为true或者false，加载到之后服务端响应200状态码。

**所以可以根据更改该属性导致状态码不同从而检测是否存在该漏洞。**

靶场环境地址：https://github.com/vulhub/vulhub/tree/master/spring/CVE-2022-22965

漏洞利用exp&环境：https://github.com/reznok/Spring4Shell-POC/blob/master/exploit.py